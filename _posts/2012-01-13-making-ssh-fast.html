---
layout: post
title: Making SSH Fast
categories: []
tags:
- Code
- Linux
- OS X
- Tips
status: publish
type: post
published: true
meta:
  aktt_notify_twitter: 'yes'
  _aktt_hash_meta: ''
  _edit_last: '1'
  aktt_tweeted: '1'
---
In my day to day work, I frequently need to bounce to various SSH servers to see whats happening or put out a fire. Nothing drives me more insane than having to wait 5-10 seconds for SSH. So I put together the various pieces in one nice package for you. (Note: this is for mac/linux only)

First, update your <code>~/.ssh/config</code> to be sure that your <code>Host *</code> section has at least this in it:

[gist id=1607514 file=.sshconfig bump=2]

Second, add this shell script to your ~/bin or wherever you keep your shell scripts:

[gist id=1607514 file=fastssh.sh bump=2]

Edit fastssh.sh and add new lines for the servers you connect to. In my above example, I have 3 servers defined "jira", "gerrit", and "bamboo".

If you want to provide additional SSH arguments like port forwarding, just add them after the hostname/username.

Finally, make sure you install <a href="http://www.harding.motd.ca/autossh/">autossh</a>.

<h2>Cool, what does all of this mean?</h2>

<ul>
    <li><code>.ssh/config</code>
        <ul>
            <li><code>ServerAliveInterval: 30</code> - Check that the connection is alive every 30 seconds.</li>
            <li><code>ServerAliveCountMax: 2</code> - If there are 2 consecutive keep alive failures, kill the connection.</li>
            <li><code>ControlPath: ~/.ssh/master-%r@%h:%p</code> - The location to save persistent connection information.</li>
            <li><code>ControlMaster: auto</code> - If there is a persistent connection, use it. If not, create one.</li>
        </ul>
    </li>
    <li><code>autossh</code> - This is a tool, that spawns SSH for you and if SSH quits for an irregular reason, relaunches ssh.</li>
</ul>

<small><em>Update:</em> Added explanation of some of the configuration and commands below.</small>

[<a href="http://news.ycombinator.com/item?id=3461355">Discuss at Hacker News</a>]
